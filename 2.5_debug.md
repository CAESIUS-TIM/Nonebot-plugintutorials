# 写插件时候的一些技巧

#### 善用搜索引擎

这其实是每个程序员都应该掌握的本领。当有什么需要使用的知识点遗忘了或者程序报了自己不会处理的错误的时候，善于使用百度，Google等搜索引擎搜索错误原因，参考别人的意见。不要怕改了程序继续出错，只怕你不去试。

#### 使用输出语句输出变量信息

Nonebot2是需要依托于gocq来在线运行的，所以调试起来非常麻烦，虽然有Nonebug插件，但是其有一定的使用门槛，不易上手。如果你不知道某个变量的内容到底是什么，那就直接使用`print`打印出其内容。比如在4_requestapp中要讲到的群申请`event.json`信息，你如果想知道它里面包含的内容和文本结构，将它打印出来或者写入本地文件都是好办法。当然，打印输入也可以使用`logger`模块，这个就看个人喜好了。

- [ ] logger包的使用方法(待写)

另外gocq和nonebot2并不是依赖运行的，调试nonebot2的同时不需要重启gocq服务，另外频繁重启gocq更易导致bot被QQ封号(在调试nonebot插件时请不要使用[NoneBot的go-cqhttp启动器](https://github.com/mnixry/nonebot-plugin-gocqhttp)插件，因为此插件会随着nonebot平台的重启而重启gocq服务)。

#### 遇到解决不了的问题时可以适当参考他人插件

很多时候有些程序处理思路是我们无法轻易想到的，这时候可以查看其它开源插件的源码，以此得到灵感。**但是不要只是单纯的CV源码**，这样缺乏自己思考的过程，下次遇到这种问题还需要去CV。

- [ ] #### NoneBug(待写)

#### 做好权限管理

一些可以操作到机器人后台数据的指令尽量都要加上`permission`参数。为什么不用`rule`？因为rule只在响应器被触发的时候生效，后续的如`got`修饰器都不会生效，而`permission`适用于整个响应器执行过程。

- [ ] 自定义规则rule类(待写)

#### 抽取共同函数/变量组成`utils`依赖包，方便统一管理。

插件较少时要管理的话较为容易，但是插件越来越多的时候，一些诸如日志输出、文件路径、适配器参数等比较难调控，改一个所有文件都要去修改，非常麻烦。这时候就需要写一个统一的`utils`来管理了，具体实例参考Nonebot商店的成品bot。

#### 待续......